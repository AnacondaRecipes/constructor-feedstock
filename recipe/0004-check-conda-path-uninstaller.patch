diff --git a/constructor/nsis/main.nsi.tmpl b/constructor/nsis/main.nsi.tmpl
index 6f5c8ae..0ac76af 100644
--- a/constructor/nsis/main.nsi.tmpl
+++ b/constructor/nsis/main.nsi.tmpl
@@ -679,15 +679,15 @@ Function un.onInit
     # not automatically elevate the uninstaller for us -- we need to do it
     # ourselves if we're not a 'Just Me' installation.
     !insertmacro UAC_PageElevation_OnInit
-    ${IfNot} ${FileExists} "$INSTDIR\.nonadmin"
+    ${IfNot} ${FileExists} "$INSTDIR\.admin"
     ${AndIfNot} ${UAC_IsAdmin}
         !insertmacro DoElevation
     ${EndIf}
 
-    ${If} ${FileExists} "$INSTDIR\.nonadmin"
-        SetShellVarContext Current
-    ${Else}
+    ${If} ${FileExists} "$INSTDIR\.admin"
         SetShellVarContext All
+    ${Else}
+        SetShellVarContext Current
     ${EndIf}
 FunctionEnd
 
@@ -996,9 +996,9 @@ Section "Install"
     # Copy extra files (code generated on winexe.py)
     @EXTRA_FILES@
 
-    ${If} $InstMode = ${JUST_ME}
+    ${If} $InstMode = ${ALL_USERS}
         SetOutPath "$INSTDIR"
-        FileOpen $0 ".nonadmin" w
+        FileOpen $0 ".admin" w
         FileClose $0
     ${EndIf}
 
